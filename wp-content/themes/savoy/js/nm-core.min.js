/* NM: Core script */
(function(b){function h(){this.BREAKPOINT_LARGE=864;this.classHeaderFixed="header-on-scroll";this.classSlideMenuOpen="slide-menu-open";this.classWidgetPanelOpen="widget-panel-open";this.$window=b(window);this.$document=b(document);this.$html=b("html");this.$body=b("body");this.$pageIncludes=b("#nm-page-includes");this.$pageOverlay=b("#nm-page-overlay");this.$widgetPanelOverlay=b("#nm-widget-panel-overlay");this.$topBar=b("#nm-top-bar");this.$header=b("#nm-header");this.$headerPlaceholder=b("#nm-header-placeholder");
this.headerScrollTolerance=0;this.$slideMenuBtn=b("#nm-slide-menu-button");this.$slideMenu=b("#nm-slide-menu");this.$slideMenuScroller=this.$slideMenu.children(".nm-slide-menu-scroll");this.$slideMenuLi=this.$slideMenu.find("ul li.menu-item");this.$widgetPanel=b("#nm-widget-panel");this.panelsAnimSpeed=200;this.$shopWrap=b("#nm-shop");this.isShop=this.$shopWrap.length?!0:!1;this.searchInHeader=this.searchEnabled=!1;"0"!==nm_wp_vars.shopSearch&&(this.searchEnabled=!0,this.$searchNotice=b("#nm-shop-search-notice"),
"header"===nm_wp_vars.shopSearch?(this.searchInHeader=!0,this.$searchBtn=b("#nm-menu-search-btn")):this.isShop&&(this.$searchBtn=b("#nm-shop-search-btn")));this.init()}b.nmThemeExtensions||(b.nmThemeExtensions={});h.prototype={init:function(){var a=this;a.$body.removeClass("nm-preload");a.headerIsFixed=a.$body.hasClass("header-fixed")?!0:!1;a.$html.hasClass("history")?(a.hasPushState=!0,window.history.replaceState({nmShop:!0},"",window.location.href)):a.hasPushState=!1;a.setScrollbarWidth();a.headerCheckPlaceholderHeight();
a.headerIsFixed&&(a.headerSetScrollTolerance(),a.slideMenuPrep());a.widgetPanelHideScrollbar();0<window.navigator.userAgent.indexOf("MSIE ")&&a.$html.addClass("nm-old-ie");a.isTouch=a.$html.hasClass("touch")?!0:!1;a.loadExtension();a.bind();a.initPageIncludes();a.$body.hasClass("nm-added-to-cart")&&(a.$body.removeClass("nm-added-to-cart"),a.$window.load(function(){a.widgetPanelShowCart(!0);setTimeout(function(){a.widgetPanelHideCartLoader()},1E3)}))},loadExtension:function(){b.nmThemeExtensions.shop&&
b.nmThemeExtensions.shop.call(this);b.nmThemeExtensions.singleProduct&&b.nmThemeExtensions.singleProduct.call(this);b.nmThemeExtensions.cart&&b.nmThemeExtensions.cart.call(this);b.nmThemeExtensions.checkout&&b.nmThemeExtensions.checkout.call(this)},setScrollbarWidth:function(){var a=document.createElement("div");a.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;";document.body.appendChild(a);this.scrollbarWidth=a.offsetWidth-a.clientWidth;document.body.removeChild(a)},
updateUrlParameter:function(a,b,e){var f=a.indexOf("#"),g=-1===f?"":a.substr(f);a=-1===f?a:a.substr(0,f);var f=new RegExp("([?&])"+b+"=.*?(&|$)","i"),d=-1!==a.indexOf("?")?"&":"?";a=a.match(f)?a.replace(f,"$1"+b+"="+e+"$2"):a+d+b+"="+e;return a+g},setPushState:function(a){this.hasPushState&&window.history.pushState({nmShop:!0},"",a)},headerCheckPlaceholderHeight:function(){if(!this.$body.hasClass(this.classHeaderFixed)){var a=this.$header.outerHeight(!0),b=parseInt(this.$headerPlaceholder.css("height"));
a!==b&&this.$headerPlaceholder.css("height",a+"px")}},headerSetScrollTolerance:function(){this.headerScrollTolerance=this.$topBar.length&&this.$topBar.is(":visible")?this.$topBar.outerHeight(!0):0},pageScrollDisable:function(){var a=this;a.isTouch&&(a.bodyScrollTop=a.$document.scrollTop(),setTimeout(function(){a.$body.addClass("disable-scroll").children(".nm-page-overflow").css("top","-"+a.bodyScrollTop+"px");a.$header.addClass("force-fix")},a.panelsAnimSpeed))},pageScrollEnable:function(){var a=
this;a.isTouch&&setTimeout(function(){a.$body.removeClass("disable-scroll");a.$document.scrollTop(a.bodyScrollTop);setTimeout(function(){a.$header.removeClass("force-fix")},100)},a.panelsAnimSpeed)},bind:function(){var a=this,c=null,e;a.$window.resize(function(){c&&clearTimeout(c);c=setTimeout(function(){e=parseInt(a.$html.css("width"));a.$body.hasClass(a.classSlideMenuOpen)&&e>a.BREAKPOINT_LARGE&&a.$pageOverlay.trigger("click");a.headerCheckPlaceholderHeight();a.headerIsFixed&&(a.headerSetScrollTolerance(),
a.slideMenuPrep())},250)});a.headerIsFixed&&(a.$window.bind("scroll",function(b){a.$document.scrollTop()>a.headerScrollTolerance?a.$body.hasClass(a.classHeaderFixed)||a.$body.addClass(a.classHeaderFixed):a.$body.hasClass(a.classHeaderFixed)&&a.$body.removeClass(a.classHeaderFixed)}),a.$window.trigger("scroll"));var f=b("#nm-top-menu").children(".menu-item"),g=b("#nm-main-menu-ul").children(".menu-item");b.merge(f,g).hover(function(){var m=b(this).children(".sub-menu");if(m.length){var c=a.$window.innerWidth(),
d=m.offset().left,g=m.width(),c=c-(d+g);0>c?m.css("left",c-33+"px"):m.css("left","")}});a.$slideMenuBtn.bind("click",function(b){b.preventDefault();a.$body.hasClass(a.classSlideMenuOpen)?(a.$body.removeClass(a.classSlideMenuOpen),a.$pageOverlay.trigger("click"),a.headerIsFixed&&a.pageScrollEnable()):(b=a.$header.outerHeight(!0),a.$slideMenuScroller.css("margin-top",b+"px"),a.$body.addClass(a.classSlideMenuOpen),a.$pageOverlay.addClass("show"),a.headerIsFixed&&a.pageScrollDisable())});a.$slideMenuLi.bind("click",
function(a){a.preventDefault();a.stopPropagation();a=b(this);var c=a.children("ul");c.length&&(a.toggleClass("active"),c.toggleClass("open"))});a.$slideMenuLi.find("a").bind("click",function(a){a.stopPropagation();var c=b(this),d=c.parent("li"),g=d.children("ul");!g.length&&"#"!=c.attr("href").substr(0,1)||d.hasClass("nm-notoggle")||(a.preventDefault(),d.toggleClass("active"),g.toggleClass("open"))});if(a.searchEnabled){a.searchInHeader&&a.$searchBtn.bind("click",function(c){c.preventDefault();b(this).toggleClass("active");
a.$body.toggleClass("header-search-open");a.searchPanelToggle()});b("#nm-shop-search-close").bind("click",function(b){b.preventDefault();a.$searchBtn.trigger("click")});var d;b("#nm-shop-search-input").on("input",function(){(d=a.shopSearchValidateInput(b(this).val()))?a.$searchNotice.addClass("show"):a.$searchNotice.removeClass("show")}).trigger("input")}a.$widgetPanel.length&&a.widgetPanelBind();b("#nm-blog-categories-toggle-link").bind("click",function(a){a.preventDefault();var c=b(this);b("#nm-blog-categories-list").slideToggle(200,
function(){var a=b(this);c.toggleClass("active");c.hasClass("active")||a.css("display","")})});b("#nm-page-overlay, #nm-widget-panel-overlay").bind("click",function(){var c=b(this);a.$body.hasClass(a.classSlideMenuOpen)?(a.$body.removeClass(a.classSlideMenuOpen),a.headerIsFixed&&a.pageScrollEnable()):a.$body.removeClass(a.classWidgetPanelOpen);c.addClass("fade-out");setTimeout(function(){c.removeClass("show fade-out")},a.panelsAnimSpeed)})},slideMenuPrep:function(){var a=this.$window.height()-this.$header.outerHeight(!0);
this.$slideMenuScroller.css({"max-height":a+"px","margin-right":"-"+this.scrollbarWidth+"px"})},searchPanelToggle:function(){var a=this,c=b("#nm-shop-search"),e=b("#nm-shop-search-input");c.slideToggle(200,function(){c.toggleClass("fade-in");c.hasClass("fade-in")?e.focus():e.val("");a.filterPanelSliding=!1});a.shopSearchHideNotice()},shopSearchValidateInput:function(a){return/\S/.test(a)&&a.length>nm_wp_vars.shopSearchMinChar-1?!0:!1},shopSearchHideNotice:function(a){b("#nm-shop-search-notice").removeClass("show")},
widgetPanelHideScrollbar:function(){0<parseInt(this.scrollbarWidth)&&this.$widgetPanel.children(".nm-widget-panel-scroll").css("marginRight","-"+this.scrollbarWidth+"px")},widgetPanelBind:function(){var a=this;if(a.isTouch){if(a.headerIsFixed)a.$pageOverlay.on("touchmove",function(a){a.preventDefault()});a.$widgetPanelOverlay.on("touchmove",function(a){a.preventDefault()});a.$widgetPanel.on("touchmove",function(a){a.stopPropagation()})}b("#nm-menu-cart-btn, #nm-slide-menu-cart-btn").bind("click",
function(c){c.preventDefault();if(a.$body.hasClass(a.classSlideMenuOpen)){var e=b(this);a.$pageOverlay.trigger("click");setTimeout(function(){e.trigger("click")},a.panelsAnimSpeed)}else a.widgetPanelShowCart()});b("#nm-widget-panel-close").bind("click",function(a){a.preventDefault();b("#nm-widget-panel-overlay").trigger("click")});a.$widgetPanel.on("click","#nm-mini-cart-empty-continue",function(a){a.preventDefault();b("#nm-widget-panel-overlay").trigger("click")});a.$widgetPanel.on("click","#nm-mini-cart-list .product-details-wrap .remove",
function(b){b.preventDefault();a.widgetPanelRemoveCartProduct(this)})},widgetPanelShowCart:function(a){a&&b("#nm-mini-cart-loader").addClass("show");this.$body.addClass(this.classWidgetPanelOpen);this.$widgetPanelOverlay.addClass("show")},widgetPanelHideCartLoader:function(a){b("#nm-mini-cart-loader").addClass("fade-out");setTimeout(function(){b("#nm-mini-cart-loader").removeClass("fade-out show")},300)},widgetPanelRemoveCartProduct:function(a){var c=b(a),e=b("#nm-mini-cart-loader");a=c.data("cart-item-key");
e.addClass("show");b.ajax({type:"POST",url:nm_wp_vars.ajaxUrl,data:{action:"nm_mini_cart_remove_product",cart_item_key:a},dataType:"json",cache:!1,headers:{"cache-control":"no-cache"},error:function(a,b,c){console.log("NM: AJAX error - widgetPanelRemoveCartProduct() - "+c);e.removeClass("show")},complete:function(a){a=a.responseJSON;"1"===a.status?(c.closest("li").remove(),b(".nm-menu-cart-count").html(a.cart_count),0==b("#nm-mini-cart-list").children().length?(b("#nm-mini-cart-inner-empty").addClass("show"),
b("#nm-mini-cart-inner").css("display","none")):b("#nm-mini-cart-subtotal").html(a.cart_subtotal)):console.log("NM: Couldn't remove product from cart");e.addClass("fade-out");setTimeout(function(){e.removeClass("fade-out show")},300)}})},initPageIncludes:function(){var a=this;!a.isTouch&&a.$pageIncludes.hasClass("video-background")&&b(".nm-row-video").each(function(){var a=b(this),c=a.data("video-url");c&&(c=vcExtractYoutubeId(c))&&insertYoutubeVideoAsBackground(a,c)});a.$window.load(function(){if(a.$pageIncludes.hasClass("blog-grid")){var c=
b("#nm-blog-grid-ul");c.packery({itemSelector:".post",gutter:0,isInitLayout:!1});c.packery("once","layoutComplete",function(){c.removeClass("nm-loader").addClass("show")});c.packery()}if(a.$pageIncludes.hasClass("banner")){var d=b(".nm-banner"),e=d.find(".nm-banner-alt-image");a.isShop&&a.filtersEnableAjax&&d.find(".nm-banner-shop-link").bind("click",function(c){c.preventDefault();b(this).attr("href")&&a.shopExternalGetPage(b(this).attr("href"))});var f=function(){if(768>=a.$window.width()){for(var c,
d,g=0;g<e.length;g++)c=b(e[g]),d=b(e[g]).data("src"),c.hasClass("img")?c.attr("src",d):c.css("background-image","url("+d+")");a.$window.unbind("resize.banners")}},h=null;a.$window.bind("resize.banners",function(){h&&clearTimeout(h);h=setTimeout(function(){f()},250)});f()}if(a.$pageIncludes.hasClass("banner-slider")){var p=function(a,b){a.$bannerContent=b.find(".nm-banner-text-inner");a.$bannerContent.length&&(a.bannerAnimation=a.$bannerContent.data("animate"),a.$bannerContent.addClass(a.bannerAnimation))};
b(".nm-banner-slider").each(function(){var c=b(this),d={arrows:!1,prevArrow:'<a class="slick-prev"><i class="nm-font nm-font-angle-thin-left"></i></a>',nextArrow:'<a class="slick-next"><i class="nm-font nm-font-angle-thin-right"></i></a>',dots:!1,edgeFriction:0,infinite:!1,pauseOnHover:!1,speed:350};c.children().wrap("<div></div>");d=b.extend(d,c.data());c.on("init",function(){a.$document.trigger("banner-slider-loaded");p(c,c.find(".slick-track .slick-active"))});c.on("afterChange",function(a,b,d){c.slideIndex!=
d&&(c.slideIndex=d,c.$bannerContent&&c.$bannerContent.removeClass(c.bannerAnimation),p(c,c.find(".slick-track .slick-active")))});c.on("setPosition",function(a,c){var d=b(c.$slides[c.currentSlide]).children(".nm-banner");d.hasClass("has-alt-image")?d.children(".nm-banner-alt-image").is(":visible")?c.$slider.addClass("alt-image-visible"):c.$slider.removeClass("alt-image-visible"):c.$slider.removeClass("alt-image-visible")});c.slick(d)})}if(a.$pageIncludes.hasClass("post-slider")){var k={adaptiveHeight:!0,
arrows:!1,dots:!0,edgeFriction:0,infinite:!1,pauseOnHover:!1,speed:350,slidesToShow:4,slidesToScroll:4,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:518,settings:{slidesToShow:1,slidesToScroll:1}}]};b(".nm-post-slider").each(function(){var a=b(this);k=b.extend(k,a.data());a.slick(k)})}a.$pageIncludes.hasClass("blog-slider")&&(d=b(".nm-blog-slider"),k={prevArrow:'<a class="slick-prev"><i class="nm-font nm-font-angle-left"></i></a>',
nextArrow:'<a class="slick-next"><i class="nm-font nm-font-angle-right"></i></a>',dots:!0,edgeFriction:0,infinite:!1,pauseOnHover:!1,speed:350,responsive:[{breakpoint:550,settings:{slidesToShow:1}}]},d.each(function(){var a=b(this);k=b.extend(k,a.data());a.slick(k)}));a.$pageIncludes.hasClass("wp-gallery")&&b(".gallery").each(function(){b(this).magnificPopup({mainClass:"nm-wp-gallery-popup nm-mfp-fade-in",closeMarkup:'<a class="mfp-close nm-font nm-font-close2"></a>',removalDelay:180,delegate:".gallery-icon > a",
type:"image",gallery:{enabled:!0,arrowMarkup:'<a title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir% nm-font nm-font-play"></a>'},closeBtnInside:!1})});if(a.$pageIncludes.hasClass("portfolio"))for(var d=b(".nm-portfolio-grid"),n=0;n<d.length;n++){var l=b(d[n]);l.parent(".nm-portfolio").hasClass("packery-enabled")&&(l.packery({itemSelector:"li",gutter:0,isInitLayout:!1}),l.packery("once","layoutComplete",function(){l.parent(".nm-portfolio").addClass("show")}),l.packery());var q=l.siblings(".nm-portfolio-filters");
q.length&&q.find("a").bind("click",function(a){a.preventDefault();a=b(this);var c=a.closest(".nm-portfolio");if(!a.hasClass("current")){c.children(".nm-portfolio-filters").children(".current").removeClass("current");a.parent("li").addClass("current");var d=c.children(".nm-portfolio-grid"),e=d.children("li"),g=a.data("filter"),f=c.hasClass("packery-enabled")?!0:!1;if(g){var h;e.each(function(){h=b(this);h.hasClass(g)?(f&&d.packery("unignore",h[0]),h.removeClass("hide fade-out")):(f&&d.packery("ignore",
h[0]),h.addClass("hide fade-out"))})}else f&&e.each(function(){d.packery("unignore",b(this)[0])}),e.removeClass("hide fade-out");f&&d.packery()}})}});if(a.$pageIncludes.hasClass("product_categories")){var c=b(".nm-product-categories");a.isShop&&a.filtersEnableAjax&&c.find(".product-category a").bind("click",function(c){c.preventDefault();a.shopExternalGetPage(b(this).attr("href"))});a.$window.load(function(){for(var a=0;a<c.length;a++){var d=b(c[a]).children(".woocommerce").children("ul");d.packery({itemSelector:".product-category",
gutter:0,isInitLayout:!1});d.packery("once","layoutComplete",function(){d.closest(".nm-product-categories").removeClass("nm-loader");d.addClass("show")});d.packery()}})}if(a.$pageIncludes.hasClass("lightbox")){var e,f;b(".nm-lightbox").each(function(){b(this).bind("click",function(a){a.preventDefault();a.stopPropagation();e=b(this);f=e.data("mfp-type");e.magnificPopup({mainClass:"nm-wp-gallery-popup nm-mfp-zoom-in",closeMarkup:'<a class="mfp-close nm-font nm-font-close2"></a>',removalDelay:180,type:f,
closeOnContentClick:!0,closeBtnInside:!1}).magnificPopup("open")})})}}};b.nmTheme=h.prototype;b(document).ready(function(){new h})})(jQuery);