function initialize(){var e=0;map_types=[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID],position=new google.maps.LatLng(contact_vars.lat,contact_vars.lng);var a={zoom:contact_vars.zoom,disableDefaultUI:!0,mapTypeId:map_types[contact_vars.map_type_id],scrollwheel:!1},t=[],o=new google.maps.LatLngBounds;map=new google.maps.Map(document.getElementById("contact-map"),a),google.maps.event.addListener(map,"click",function(e){map.setOptions({scrollwheel:!0})}),jQuery("#contact-map").on("mouseout",function(){map.setOptions({scrollwheel:!1})});var n=contact_vars.shopPin;jQuery.each(contact_vars.locations,function(e,a){var s=new google.maps.LatLng(a.lat,a.lng);"object"==typeof contact_vars.pinSize&&(contact_vars.shopPin=new google.maps.MarkerImage(n,null,null,null,new google.maps.Size(contact_vars.pinSize[0]/2,contact_vars.pinSize[1]/2))),t.push(new google.maps.Marker({position:s,map:map,icon:contact_vars.shopPin})),o.extend(s)}),map.panBy(pan_x,pan_y),map.setCenter(o.getCenter()),contact_vars.fourtyFive&&(map.setTilt(45),map.setHeading(e)),panorama=map.getStreetView(),panorama.setPosition(position),panorama.setPov({heading:contact_vars.streetViewHeading,pitch:contact_vars.streetViewPitch}),panorama.setOptions({panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1}),3==contact_vars.map_type_id&&panorama.setVisible(!0);var s=jQuery(".map-type-switcher a").not(".rotate-view"),i=jQuery(".map-type-switcher .rotate-view");s.on("click",function(a){a.preventDefault();var t=jQuery(this);switch(s.removeClass("current"),t.addClass("current"),"street"==t.data("type")?panorama.setVisible(!0):panorama.setVisible(!1),t.data("type")){case"roadmap":map.setMapTypeId(map_types[0]);break;case"hybrid":map.setMapTypeId(map_types[2]);break;case"street":panorama.setZoom(1);break;default:map.setMapTypeId(map_types[1])}switch(t.data("type")){case"hybrid":case"satellite":s.parent().addClass("satellite-view");break;default:s.parent().removeClass("satellite-view")}map.setCenter(position),map.panBy(pan_x,pan_y),contact_vars.fourtyFive&&(map.setTilt(45),map.setHeading(e))}),i.click("click",function(a){a.preventDefault(),contact_vars.fourtyFive&&(e+=90,map.setTilt(45),map.setHeading(e))}),jQuery(window).on("lab.resize",function(e){resizeMapContainer()}),resizeMapContainer();var r=jQuery(".contact-blocks-env"),p=jQuery(".toggle-info-blocks"),l="hidden-blocks";p.click(function(e){e.preventDefault();var a=r.hasClass(l),t=p.data("visible");a?r.removeClass(l):(t=p.data("hidden"),r.addClass(l)),p.html(t)})}function resizeMapContainer(){var e=jQuery("#contact-map.contact-map-canvas");public_vars.$body.hasClass("ht-1")&&e.css({minHeight:jQuery(window).height()}),google.maps.event.trigger(map,"resize")}google.maps.event.addDomListener(window,"load",initialize),jQuery(document).ready(function($){function e(e,a){var t="http://maps.googleapis.com/maps/api/directions/json?origin="+e+"&destination="+a+"&sensor=false";$.getJSON(ajaxurl,{action:"laborator_calc_route",route_path:t},function(e){if(s.removeClass("loading"),"OK"!=e.status)return r.slideDown("fast"),p.hide(),void l.removeClass("visible");r.slideUp("fast"),$.each(c,function(e,a){a.setMap(null)});var a=e.routes[0].overview_polyline.points,t=google.maps.geometry.encoding.decodePath(a),o=new google.maps.Polyline({path:t,geodesic:!0,strokeColor:s.css("backgroundColor"),strokeOpacity:.9,strokeWeight:4}),n=e.routes[0].legs[0].distance,i=e.routes[0].legs[0].duration,d=new google.maps.LatLngBounds;o.getPath().forEach(function(e){d.extend(e)}),map.fitBounds(d),o.setMap(map),c.push(o);var m=t[t.length-1],u=new google.maps.Marker({position:m,map:map,icon:contact_vars.carPin});c.push(u);var g=parseFloat(n.value/1e3).toFixed(2);g>1e3&&(g=parseInt(g)),p.find(".route-detail.time span").html(parseInt(Math.round(i.value/60))),p.find(".route-detail.distance span").html(g),map.panBy(pan_x,pan_y),p.show(),l.addClass("visible")})}var a=$(".route-options-container"),t=$(".route-options"),o=$(".show-me-the-route > a"),n=t.find(".address-field"),s=a.find("#calc-route"),i=n.find('input[type="text"]'),r=a.find(".route-error"),p=a.find(".route-details"),l=a.find(".route-clear"),c=[];o.on("click",function(e){e.preventDefault(),a.slideToggle("fast")}),l.on("click",function(e){e.preventDefault(),l.removeClass("visible"),$.each(c,function(e,a){a.setMap(null)}),map.setCenter(position),map.panBy(pan_x,pan_y),p.hide(),i.val("")}),i.keyup(function(e){13==e.keyCode&&s.trigger("click")}),!navigator.geolocation&&t.length>1?(t.first().remove(),n.show()):t.on("change",'input[type="radio"]',function(e){var a=$(this);"address"==a.val()?(n.slideDown("fast"),i.focus()):n.slideUp("fast")}),t.find('input[type="radio"]').first().attr("checked",!0),s.click(function(a){var o=t.find('input[type="radio"]:checked').val(),n=parseInt($("#current-contact-address").val(),10),r=contact_vars.locations[n];if(p.hide(),"address"==o)if($.trim(i.val()).length>0){s.addClass("loading");var l=new google.maps.Geocoder;l.geocode({address:i.val()},function(a,t){if(t==google.maps.GeocoderStatus.OK){var o=a[0].geometry.location;i.next().removeClass("visible");var n=r.lat+","+r.lng,s=o.lat()+","+o.lng();e(n,s)}else i.next().addClass("visible")})}else i.focus();else"gps"==o&&(s.addClass("loading"),navigator.geolocation.getCurrentPosition(function(a){var t=a.coords.latitude+","+a.coords.longitude,o=r.lat+","+r.lng;e(o,t)}))})});