jQuery(function(a){function b(){var a={formatMatches:function(a){return 1===a?wc_bundles_admin_params.i18n_matches_1:wc_bundles_admin_params.i18n_matches_n.replace("%qty%",a)},formatNoMatches:function(){return wc_bundles_admin_params.i18n_no_matches},formatAjaxError:function(a,b,c){return wc_bundles_admin_params.i18n_ajax_error},formatInputTooShort:function(a,b){var c=b-a.length;return 1===c?wc_bundles_admin_params.i18n_input_too_short_1:wc_bundles_admin_params.i18n_input_too_short_n.replace("%qty%",c)},formatInputTooLong:function(a,b){var c=a.length-b;return 1===c?wc_bundles_admin_params.i18n_input_too_long_1:wc_bundles_admin_params.i18n_input_too_long_n.replace("%qty%",c)},formatSelectionTooBig:function(a){return 1===a?wc_bundles_admin_params.i18n_selection_too_long_1:wc_bundles_admin_params.i18n_selection_too_long_n.replace("%qty%",a)},formatLoadMore:function(a){return wc_bundles_admin_params.i18n_load_more},formatSearching:function(){return wc_bundles_admin_params.i18n_searching}};return a}function c(){a(".wc-bundled-items .wc-bundled-item").each(function(b,c){a(".bundled_item_position",c).val(parseInt(a(c).index(".wc-bundled-items .wc-bundled-item")))})}function d(){a(".wc-bundled-items").on("change",".filter_variations input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.bundle_variation_filters").show():a(this).closest("div.item-data").find("div.bundle_variation_filters").hide()}).on("change",".override_defaults input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.bundle_selection_defaults").show():a(this).closest("div.item-data").find("div.bundle_selection_defaults").hide()}).on("change",".override_title input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_title").show():a(this).closest("div.item-data").find("div.custom_title").hide()}).on("change",".override_description input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_description").show():a(this).closest("div.item-data").find("div.custom_description").hide()}).on("change",".item_visibility select",function(){"visible"==a(this).val()?(a(this).closest("div.item-data").find(".override_title, .override_description, .images").show(),a(this).closest("div.item-data").find(".override_title input").change(),a(this).closest("div.item-data").find(".override_description input").change()):a(this).closest("div.item-data").find(".override_title, .custom_title, .override_description, .custom_description, .images").hide()}),a(".wc-bundled-items .filter_variations input").change(),a(".wc-bundled-items .override_defaults input").change(),a(".wc-bundled-items .override_title input").change(),a(".wc-bundled-items .override_description input").change(),a(".wc-bundled-items .item_visibility select").change();var b=a(".wc-bundled-items").find(".wc-bundled-item").get();b.sort(function(b,c){var d=parseInt(a(b).attr("rel")),e=parseInt(a(c).attr("rel"));return e>d?-1:d>e?1:0}),a(b).each(function(b,c){a(".wc-bundled-items").append(c)}),a(".wc-bundled-items").sortable({items:".wc-bundled-item",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style"),c()}}),a("#bundled_product_data .wc-bundle-metaboxes-wrapper").on("click","button.remove_row",function(){var b=a(this).closest(".wc-bundled-item");b.find("*").off(),b.remove(),c()}),a("#bundled_product_data .expand_all").click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").show(),!1}),a("#bundled_product_data .close_all").click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").hide(),!1})}a.fn.wc_bundles_select2=function(){a(this).find(":input.wc-enhanced-select").filter(":not(.enhanced)").each(function(){var c=a.extend({minimumResultsForSearch:10,allowClear:a(this).data("allow_clear")?!0:!1,placeholder:a(this).data("placeholder")},b());a(this).select2(c).addClass("enhanced")})},a(".bundle_stock_msg").insertBefore("._manage_stock_field"),a("body").on("woocommerce-product-type-change",function(b,c,d){"bundle"===c&&(a("input#_downloadable").prop("checked",!1),a("input#_virtual").removeAttr("checked"),a(".show_if_simple").show(),a(".show_if_external").hide(),a("input#_downloadable").closest(".show_if_simple").hide(),a("input#_virtual").closest(".show_if_simple").hide(),a("input#_manage_stock").change(),a("input#_per_product_pricing_active").change(),a("input#_per_product_shipping_active").change(),a("#_nyp").change())}),a("select#product-type").change(),a("input#_per_product_shipping_active").change(function(){"bundle"===a("select#product-type").val()&&(a("input#_per_product_shipping_active").is(":checked")?(a(".show_if_virtual").show(),a(".hide_if_virtual").hide(),a(".shipping_tab").hasClass("active")&&a("ul.product_data_tabs li:visible").eq(0).find("a").click()):(a(".show_if_virtual").hide(),a(".hide_if_virtual").show()))}).change(),a("input#_per_product_pricing_active").change(function(){"bundle"===a("select#product-type").val()&&(a(this).is(":checked")?(a("#_regular_price").val(""),a("#_sale_price").val(""),a("._tax_class_field").closest(".options_group").hide(),a(".pricing").hide(),a("#bundled_product_data .wc-bundled-item .item-data .discount input.bundle_discount").each(function(){a(this).attr("disabled",!1)})):(a("._tax_class_field").closest(".options_group").show(),a("#_nyp").is(":checked")||a(".pricing").show(),a("#bundled_product_data .wc-bundled-item .item-data .discount input.bundle_discount").each(function(){a(this).attr("disabled","disabled")})))}).change(),a("#_nyp").change(function(){"bundle"===a("select#product-type").val()&&(a("#_nyp").is(":checked")?(a("input#_per_product_pricing_active").prop("checked",!1),a(".bundle_pricing").hide()):a(".bundle_pricing").show(),a("input#_per_product_pricing_active").change())}).change(),d();var e=a("#bundled_product_data .wc-bundled-items .wc-bundled-item").size(),f={};f="yes"==wc_bundles_admin_params.is_wc_version_gte_2_3?{message:null,overlayCSS:{background:"#fff",opacity:.6}}:{message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}},a("#bundled_product_data").on("click","button.add_bundled_product",function(){var b=a("#bundled_product_data #bundled_product").val();if(!b>0)return"yes"===wc_bundles_admin_params.is_wc_version_gte_2_3?a("#bundled_product_data .bundled_product_selector .wc-product-search").select2("open"):a("#bundled_product_data .bundled_product_selector .ajax_chosen_select_products").trigger("chosen:open.chosen"),!1;"yes"===wc_bundles_admin_params.is_wc_version_gte_2_3&&a("#bundled_product_data .bundled_product_selector .wc-product-search").select2("val",""),a("#bundled_product_data").block(f),e++;var c={action:"woocommerce_add_bundled_product",post_id:woocommerce_admin_meta_boxes.post_id,id:e,product_id:b,security:wc_bundles_admin_params.add_bundled_product_nonce};return a.post(woocommerce_admin_meta_boxes.ajax_url,c,function(b){if(""!==b.markup){a("#bundled_product_data .wc-bundled-items").append(b.markup);var c=a("#bundled_product_data .wc-bundled-items .wc-bundled-item").last();"yes"==wc_bundles_admin_params.is_wc_version_gte_2_3?c.wc_bundles_select2():c.find(".chosen_select").chosen(),c.find(".filter_variations input").change(),c.find(".override_defaults input").change(),c.find(".override_title input").change(),c.find(".override_description input").change(),c.find(".item_visibility select").change(),c.find(".help_tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),a("input#_per_product_pricing_active").change(),a("#bundled_product_data").trigger("wc-bundles-added-bundled-product")}else""!==b.message&&alert(b.message);a("#bundled_product_data").unblock()}),!1})});