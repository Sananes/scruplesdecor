jQuery(document).ready(function(a){"use strict";a.wc_additional_variation_images_admin={getVariationIDs:function(){var i=[];return a.each(a("#variable_product_options .woocommerce_variation"),function(){i.push(a(this).find(".upload_image .upload_image_button").prop("rel"))}),i},runSortable:function(){a.each(a("#variable_product_options .woocommerce_variation"),function(){var i=a(this).find("a.upload_image_button").prop("rel");a(this).find("ul.wc-additional-variations-images-list").sortable({update:function(){a.wc_additional_variation_images_admin.prepThumbs(i)},placeholder:"sortable-placeholder",cursor:"move"})})},prepThumbs:function(i){if(!(i.length<=0)){var t=[],o=a('#variable_product_options .woocommerce_variation a.upload_image_button[rel="'+i+'"]').parent(".upload_image");o.find("ul.wc-additional-variations-images-list li").length?(a.each(o.find("ul.wc-additional-variations-images-list li"),function(){t.push(a(this).find("a.wc-additional-variations-images-thumb").data("id"))}),o.find("input.wc-additional-variations-images-thumbs-save").val(t)):o.find("input.wc-additional-variations-images-thumbs-save").val(""),t.join(",")}},init:function(){var i=wc_additional_variation_images_local,t={action:"wc_additional_variation_images_load_images_ajax",ajaxAdminLoadImageNonce:wc_additional_variation_images_local.ajaxAdminLoadImageNonce,variation_ids:a.wc_additional_variation_images_admin.getVariationIDs()};a.wc_additional_variation_images_admin.getVariationIDs().length&&a.post(wc_additional_variation_images_local.ajaxurl,t,function(t){t=a.parseJSON(t);for(var o in t.images)if(t.images.hasOwnProperty(o)){var n='<h4 class="wc-additional-variation-images-title">'+i.adminTitleText+' <a href="#" class="wc-additional-variations-images-tip" data-tip="'+i.adminAddImagesTip+'">[?]</a></h4>'+t.images[o]+'<a href="#" class="add-additional-images">'+i.adminAddImagesText+"</a>";a('#variable_product_options .woocommerce_variation a.upload_image_button[rel="'+o+'"]').parents(".upload_image").find("a.wc-additional-variations-images-tip").length||a('#variable_product_options .woocommerce_variation a.upload_image_button[rel="'+o+'"]').after(n)}a(".wc-additional-variations-images-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50}),a.wc_additional_variation_images_admin.runSortable()}),a("#variable_product_options .woocommerce_variation").on("click","a.add-additional-images",function(t){t.preventDefault();var o,n=a(this).parents(".upload_image").find("a.upload_image_button").prop("rel"),e=a(this).parents(".upload_image").find("ul.wc-additional-variations-images-list");o=wp.media.frames.mediaFrame=wp.media({title:i.adminMediaTitle,button:{text:i.adminMediaAddImageText},library:{type:"image"},multiple:!0}),o.on("select",function(){var i=o.state().get("selection");i.map(function(a){if(a=a.toJSON(),a.id){var i=a.sizes.thumbnail?a.sizes.thumbnail.url:a.url;e.append(wc_additional_variation_images_local.is23?'<li><a href="#" class="wc-additional-variations-images-thumb" data-id="'+a.id+'"><img src="'+i+'" /><span class="overlay"></span></a></li>':'<li><a href="#" class="wc-additional-variations-images-thumb" data-id="'+a.id+'"><img src="'+i+'" width="40" height="40" /><span class="overlay"></span></a></li>')}}),wp.media.model.settings.post.id=n,a.wc_additional_variation_images_admin.runSortable(),a.wc_additional_variation_images_admin.prepThumbs(n)}),o.open()}),a("#variable_product_options .woocommerce_variation").on("click","a.wc-additional-variations-images-thumb",function(i){i.preventDefault();var t=a(this).parents(".upload_image").find("a.upload_image_button").prop("rel");a(this).parent("li").remove(),a.wc_additional_variation_images_admin.prepThumbs(t)})}},a.wc_additional_variation_images_admin.init(),a("body").on("woocommerce_variations_added",function(){a.wc_additional_variation_images_admin.init()})});